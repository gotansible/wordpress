---

- name: depend - apt common packages
  apt:
    name={{ item }}
    state=present
    update_cache=yes
  with_items:
    - php5-gd
    - libssh2-php

- name: depend - hhvm key
  apt_key:
    url=http://dl.hhvm.com/conf/hhvm.gpg.key
    state=present
  when: wordpress_hhvm

- name: depend - hhvm repo
  apt_repository:
    repo='deb http://dl.hhvm.com/ubuntu trusty main'
    state=present
  when: wordpress_hhvm

- name: depend - hhvm apt-get
  apt:
    name=hhvm
    state=present
    update_cache=yes
    cache_valid_time=3600
  when: wordpress_hhvm

- name: depend - hhvm install_fastcgi
  shell: /usr/share/hhvm/install_fastcgi.sh

- name: depend - php5-fpm
  apt:
    name={{ item }}
    state=present
    update_cache=yes
  with_items:
    - php5-fpm
    - php5-mysql
    - php5-mcrypt
    - php5-gd
    - php5-curl
  when: not wordpress_hhvm


#wget -O - http://dl.hhvm.com/conf/hhvm.gpg.key | sudo apt-key add -
#echo deb http://dl.hhvm.com/ubuntu trusty main | sudo tee /etc/apt/sources.list.d/hhvm.list
#sudo apt-get update
#sudo apt-get install hhvm
#sudo update-rc.d hhvm defaults

